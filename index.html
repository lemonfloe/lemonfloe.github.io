<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="/style.css?v=20250619" rel="stylesheet" type="text/css" media="all" />
    <title>Cryosolis</title>
    <link rel="icon" type="image/x-icon" href="images/icons/favicon.png" />
</head>

<body>

    <div class="autoplayer">
        <div>
            <button id="autoplayer__button">⏯</button>
        </div>

        <audio loop id="autoplayer__audio">
            <source src="https://lemonfloe.github.io/assets/music/background_audio.ogg" type="audio/ogg">
        </audio>

        <a id="nowPlaying" target="_blank" href="https://www.youtube.com/watch?v=szdWkrRHpAw">Now
            Playing:<br>Countless
            grains arranged
            in a grid are waving randomly<br>MΣΣBΣΣ a.k.a KAZUHIRO ABO</a>

        <script>
            const audio = document.getElementById('autoplayer__audio');
            audio.volume = 0;

            let fadeInInterval;
            const fadeInDuration = 1000;

            function audioFadeIn() {
                let volume = 0;
                const increment = 0.01;
                const steps = 1 / increment;
                const intervalTime = fadeInDuration / steps;

                fadeInInterval = setInterval(() => {
                    volume += increment;
                    if (volume > 1) {
                        volume = 1;
                        audio.volume = volume;
                        clearInterval(fadeInInterval);
                    } else {
                        audio.volume = volume;
                    }
                }, intervalTime);
            }

            document.getElementById('autoplayer__button').addEventListener('click', () => {
                audio.play();
                audioFadeIn();
            })
        </script>
    </div>

    <div id="background"></div>
    <div id="snowholder">
        <div class="snow snow1"></div>
        <div class="snow snow2"></div>
        <div class="snow snow3"></div>
    </div>

    <nav>
        <button class="nav__button">Home</button>
        <button class="nav__button">Profiles</button>
        <button class="nav__button">Creations</button>
        <button class="nav__button">Gaming</button>
    </nav>

    <div id="pageContent">
    </div>
</body>

<script>

    const pageFiles = [
        'homepage.html',
        'profiles.html',
        'creations.html',
        'gaming.html'
    ];

    let currentPageIndex = null;
    let currentPage = 0;

    window.addEventListener("DOMContentLoaded", changeContent('homepage.html'), (currentPage = 0));

    document.querySelectorAll(".nav__button").forEach(function (button, index) {
        button.addEventListener("click", async function () {
            currentPageIndex = index;
            const contentURL = pageFiles[currentPageIndex];
            await fadeOut(pageContent);
            await changeContent(contentURL);
            fadeIn(pageContent);
        });
    });

    function changeContent(contentURL) {
        if (currentPage != currentPageIndex) {
            fetch(contentURL)
                .then(res => {
                    return res.text();
                })
                .then(cont => {
                    var divPlaceholder = document.getElementById('pageContent');
                    document.getElementById('pageContent').innerHTML = "";
                    divPlaceholder.insertAdjacentHTML("afterbegin", cont);
                })
                .then(currentPage = currentPageIndex);
        } else {
            console.log('already here!');
        }
    };

    function fadeOut(element) {
        return new Promise((resolve) => {
            let opacity = 1;
            function fade() {
                opacity -= 0.06;
                if (opacity <= 0) {
                    element.style.opacity = 0;
                    resolve();
                } else {
                    element.style.opacity = opacity;
                    requestAnimationFrame(fade);
                }
            }
            fade();
        });
    }

    function fadeIn(element) {
        return new Promise((resolve) => {
            let opacity = null;
            function fade() {
                opacity += 0.015;
                if (opacity >= 1) {
                    element.style.opacity = 1;
                    resolve();
                } else {
                    element.style.opacity = opacity;
                    requestAnimationFrame(fade);
                }
            }
            fade();
        });
    }

</script>

</html>